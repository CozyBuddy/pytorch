import pandas as pd

train = pd.read_csv('score_train.csv')

test = pd.read_csv('score_test.csv')

print(train.head())
print(test.head())

print(list(train.columns))

print(train.isnull().sum())
print(test.isnull().sum())

print(train.info())
print(test.info())

cols = list(train.columns[train.dtypes == 'object'])

print(cols)

target = train.pop('Credit_Score')

combined = pd.concat([train,test])

combined_as = pd.get_dummies(combined)
n_train = len(train)

train = combined_as[:n_train]
test = combined_as[n_train:]

print(test.head())
print(train.head())

from sklearn.model_selection import train_test_split
X_train,X_val ,y_train,y_val = train_test_split(train,target , test_size=0.2 , random_state=0)

from sklearn.ensemble import RandomForestClassifier

rf = RandomForestClassifier()
rf.fit(X_train,y_train)

y_pred = rf.predict(X_val)

print(y_pred)

pred = rf.predict(test)
submit = pd.DataFrame({'pred' : pred})
submit.to_csv('result.csv' , index=False)

from sklearn.metrics import f1_score

f1 = f1_score(y_val, y_pred, average='macro')

print(f1)

import pandas as pd

train = pd.read_csv('drug_train.csv')
test = pd.read_csv('drug_test.csv')

print(test.head())
print(train.head())

print(train.isnull().sum())
print(test.isnull().sum())

target = train.pop('Drug')

cols = list(train.columns[train.dtypes == 'object'])

print(list(cols))

combined = pd.concat([train,test])

combined_as = pd.get_dummies(combined)

n_train = len(train)

train = combined_as[:n_train]
test = combined_as[n_train:]

print(test.head())
print(train.head())

from sklearn.model_selection import train_test_split

X_train , X_val , y_train , y_val = train_test_split(train,target,test_size=0.2 , random_state=0)

from sklearn.ensemble import RandomForestClassifier

rf = RandomForestClassifier()
rf.fit(X_train,y_train)

y_pred = rf.predict(X_val)

from sklearn.metrics import f1_score

f1 = f1_score(y_val , y_pred , average='macro')
print(f1)

pred = rf.predict(test)

submit = pd.DataFrame({'pred' : pred})

submit.to_csv('result.csv', index=False)


train = pd.read_csv('glass_train.csv')
test = pd.read_csv('glass_test.csv')

print(train.isnull().sum())
print(test.isnull().sum())

print(test.info())
target = train.pop('Type')

combined = pd.concat([train,test])

combined_as = pd.get_dummies(combined)

n_train = len(train)

train = combined_as[:n_train]
test = combined_as[n_train:]

from sklearn.model_selection import train_test_split

X_train,X_val , y_train,y_val = train_test_split(train,target , test_size=0.2 , random_state=0)

from sklearn.ensemble import RandomForestClassifier

rf = RandomForestClassifier()
rf.fit(X_train,y_train)

y_pred = rf.predict(X_val)

from sklearn.metrics import f1_score

f1 = f1_score(y_val , y_pred , average='weighted')

print(f1)

pred = rf.predict(test)
submit = pd.DataFrame({'pred' : pred})

submit.to_csv('result.csv' , index=False)